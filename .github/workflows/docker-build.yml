# Copyright (c) 2025-2026 BlackRoad OS, Inc. All Rights Reserved.
name: Docker Lint

on:
  push:
    branches: [main]
    paths: ['docker/**', '.hadolint.yaml']
  pull_request:
    branches: [main]
    paths: ['docker/**', '.hadolint.yaml']

jobs:
  lint:
    runs-on: [self-hosted, blackroad-fleet]
    strategy:
      matrix:
        service: [core, web, agents, operator]
    steps:
      - uses: actions/checkout@v6
      - uses: hadolint/hadolint-action@v3.3.0
        with:
          dockerfile: docker/${{ matrix.service }}/Dockerfile

  compose:
    runs-on: [self-hosted, blackroad-fleet]
    steps:
      - uses: actions/checkout@v6
      - name: Validate docker-compose
        run: docker compose -f docker/docker-compose.yml config --quiet
